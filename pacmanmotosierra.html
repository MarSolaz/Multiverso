<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üïπÔ∏è Estudiar vs Motosierra üïπÔ∏è</title>
<style>
  body {
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: 'Courier New', monospace;
    background-color: white;
  }

  h1 {
    font-size: 30px;
    margin-top: 10px;
    text-align: center;
    text-shadow: 0 0 10px #00ff00;
  }

  canvas {
    border: 1px solid black;
    margin-top: 10px;
    touch-action: none;
    width: 100%;
    max-width: 600px;
    height: auto;
  }

  button {
    font-size: 20px;
    margin: 5px;
    cursor: pointer;
    padding: 10px 20px;
    border: none;
    background-color: #4CAF50;
    color: white;
    border-radius: 5px;
  }

  #muteButton {
    position: fixed;
    top: 10px;
    right: 10px;
    background: transparent;
    border: none;
    font-size: 24px;
    cursor: pointer;
  }

  #mobileControls {
    display: none;
    margin-top: 15px;
    text-align: center;
  }

  .control-row {
    display: flex;
    justify-content: center;
  }

  .control-btn {
    width: 60px;
    height: 60px;
    font-size: 30px;
    margin: 5px;
    border-radius: 50%;
    background: #222;
    color: white;
  }

  @media (max-width: 768px) {
    #mobileControls {
      display: block;
    }
  }
</style>
</head>
<body>
<h1>üïπÔ∏è Estudiar vs Motosierra üïπÔ∏è</h1>
<canvas id="gameCanvas"></canvas>
<button id="restartButton" style="display: none;">Reiniciar Juego</button>
<button id="muteButton">üîä</button>

<div id="mobileControls">
  <div class="control-row">
    <button class="control-btn" data-dir="up">‚¨ÜÔ∏è</button>
  </div>
  <div class="control-row">
    <button class="control-btn" data-dir="left">‚¨ÖÔ∏è</button>
    <button class="control-btn" data-dir="down">‚¨áÔ∏è</button>
    <button class="control-btn" data-dir="right">‚û°Ô∏è</button>
  </div>
</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

// Im√°genes
const pacmanImg = new Image(); pacmanImg.src = "pacman2.png";
const motosierraImg = new Image(); motosierraImg.src = "motosierra.png";
const bookImg = new Image(); bookImg.src = "hoja.png";
const heartImg = new Image(); heartImg.src = "heart.png";

// Tama√±os y velocidades
const ORIGINAL_WIDTH = 600;
const ORIGINAL_HEIGHT = 400;
const CHARACTER_SIZE = 50;
const PACMAN_SPEED = 16;
const ENEMY_SPEED = 2;

// Personajes y libros
let pacman = { x: 200, y: 200, lives: 3 };
let motosierra = { x: 50, y: 50 };
let books = [];
for (let i = 0; i < 15; i++) {
  books.push({ 
    x: Math.random() * (ORIGINAL_WIDTH - CHARACTER_SIZE),
    y: Math.random() * (ORIGINAL_HEIGHT - CHARACTER_SIZE),
    eaten: false 
  });
}

// Audio
const audio = new Audio('arcades.mp3');
audio.loop = true;
audio.volume = 0.5;
audio.play();

document.getElementById("muteButton").addEventListener("click", function() {
  if (audio.paused) { audio.play(); this.textContent="üîä"; }
  else { audio.pause(); this.textContent="üîá"; }
});

// Ajuste de canvas y escala
let scale = 1;
function resizeCanvas() {
  canvas.width = canvas.clientWidth;
  canvas.height = canvas.clientWidth * (ORIGINAL_HEIGHT / ORIGINAL_WIDTH);
  scale = canvas.width / ORIGINAL_WIDTH;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

// Dibujo
function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  const scaledCharacter = CHARACTER_SIZE * scale;

  ctx.drawImage(pacmanImg, pacman.x*scale, pacman.y*scale, scaledCharacter, scaledCharacter);
  ctx.drawImage(motosierraImg, motosierra.x*scale, motosierra.y*scale, scaledCharacter*2, scaledCharacter*2);

  books.forEach(book => {
    if (!book.eaten) ctx.drawImage(bookImg, book.x*scale, book.y*scale, scaledCharacter, scaledCharacter);
  });

  for (let i = 0; i < pacman.lives; i++) {
    ctx.drawImage(heartImg, i*scaledCharacter, 0, scaledCharacter, scaledCharacter);
  }
}

// Movimiento Pac-Man
function movePacman(direction) {
  if (direction==="left") pacman.x -= PACMAN_SPEED;
  if (direction==="right") pacman.x += PACMAN_SPEED;
  if (direction==="up") pacman.y -= PACMAN_SPEED;
  if (direction==="down") pacman.y += PACMAN_SPEED;

  pacman.x = Math.max(0, Math.min(ORIGINAL_WIDTH - CHARACTER_SIZE, pacman.x));
  pacman.y = Math.max(0, Math.min(ORIGINAL_HEIGHT - CHARACTER_SIZE, pacman.y));

  checkCollisions();
}

// Colisiones
function checkCollisions() {
  if (isCollision(pacman, motosierra)) {
    pacman.lives--;
    if (pacman.lives <= 0) {
      showDefeat();
      return;
    }
    pacman.x = 200; pacman.y = 200;
  }

  books.forEach(b => {
    if (!b.eaten && isCollision(pacman, b)) b.eaten = true;
  });

  if (books.every(b => b.eaten)) showVictory();
}

function isCollision(obj1, obj2) {
  return obj1.x < obj2.x + CHARACTER_SIZE &&
         obj1.x + CHARACTER_SIZE > obj2.x &&
         obj1.y < obj2.y + CHARACTER_SIZE &&
         obj1.y + CHARACTER_SIZE > obj2.y;
}

// Motosierra
function updateMotosierra() {
  motosierra.x += (pacman.x < motosierra.x ? -ENEMY_SPEED : ENEMY_SPEED);
  motosierra.y += (pacman.y < motosierra.y ? -ENEMY_SPEED : ENEMY_SPEED);

  motosierra.x = Math.max(0, Math.min(ORIGINAL_WIDTH - CHARACTER_SIZE*2, motosierra.x));
  motosierra.y = Math.max(0, Math.min(ORIGINAL_HEIGHT - CHARACTER_SIZE*2, motosierra.y));
}

// Controles teclado
document.addEventListener("keydown", e => {
  if(e.key==="ArrowLeft") movePacman("left");
  if(e.key==="ArrowRight") movePacman("right");
  if(e.key==="ArrowUp") movePacman("up");
  if(e.key==="ArrowDown") movePacman("down");
});

// Controles m√≥viles continuos
let mobileDirection = null;
document.querySelectorAll(".control-btn").forEach(btn=>{
  btn.addEventListener("touchstart", e=>{
    e.preventDefault(); mobileDirection = btn.dataset.dir;
  });
  btn.addEventListener("touchend", e=>{
    e.preventDefault(); mobileDirection = null;
  });
});

// Reiniciar juego
document.getElementById("restartButton").addEventListener("click", restartGame);
function restartGame() {
  pacman = { x: 200, y: 200, lives: 3 };
  motosierra = { x: 50, y: 50 };
  books = [];
  for(let i=0;i<15;i++){
    books.push({ x: Math.random()*(ORIGINAL_WIDTH-CHARACTER_SIZE),
                 y: Math.random()*(ORIGINAL_HEIGHT-CHARACTER_SIZE),
                 eaten:false });
  }
  document.getElementById("restartButton").style.display = "none";
  gameLoop(); 
}

// Mensajes de victoria y derrota (ajuste para m√≥viles)
let gameLoopId;
function showVictory() {
  ctx.setTransform(1,0,0,1,0,0); // reset escala
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.font = `${40*scale}px Arial`;
  ctx.fillStyle = "green";
  ctx.textAlign = "center";
  ctx.textBaseline = "middle";
  ctx.fillText("üéâ FELICIDADES, LO LOGRASTE! üéâ", canvas.width/2, canvas.height/2);
  mobileDirection = null;
  document.getElementById("restartButton").style.display = "block";
  cancelAnimationFrame(gameLoopId);
}

function showDefeat() {
  ctx.setTransform(1,0,0,1,0,0); // reset escala
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.font = `${40*scale}px Arial`;
  ctx.fillStyle = "red";
  ctx.textAlign = "center";
  ctx.textBaseline = "middle";
  ctx.fillText("¬°AFUEeeRAaa!", canvas.width/2, canvas.height/2);
  mobileDirection = null;
  document.getElementById("restartButton").style.display = "block";
  cancelAnimationFrame(gameLoopId);
}

// Game loop
function gameLoop(){
  if(mobileDirection) movePacman(mobileDirection);
  updateMotosierra();
  draw();
  gameLoopId = requestAnimationFrame(gameLoop);
}
gameLoop();
</script>
</body>
</html>

